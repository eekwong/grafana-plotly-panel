{"version":3,"sources":["../src/module.js"],"names":["MetricsPanelCtrl","_","moment","angular","Plotly","PlotlyPanelCtrl","$scope","$injector","$q","$rootScope","$timeout","$window","timeSrv","uiSegmentSrv","q","sizeChanged","initalized","$tooltip","$","dcfg","mapping","x","y","z","color","size","settings","type","mode","displayModeBar","showLegend","line","width","dash","shape","marker","symbol","colorscale","sizemode","sizemin","sizeref","showscale","groupToSeries","color_option","layout","autosize","showlegend","legend","dragmode","hovermode","plot_bgcolor","paper_bgcolor","font","family","margin","t","b","l","r","xaxis","showgrid","zeroline","gridcolor","rangemode","yaxis","scene","title","zaxis","panel","pconfig","extend","cfg","trace","events","on","onInitEditMode","bind","onRender","onDataReceived","onDataError","onPanelInitalized","onRefresh","element","onResize","err","seriesList","render","console","log","graph","redraw","addEditorTab","refresh","segs","newSegment","value","subTabIndex","axis","disp","idx","config","metric","name","onConfigChanged","s","options","showLink","displaylogo","modeBarButtonsToRemove","data","constructor","Array","rect","getBoundingClientRect","old","height","newPlot","i","points","length","pointNumber","ts","msg","toPrecision","appEvent","dashboard","formatDate","xxx","mouse","pt","body","html","place_tt","pageX","pageY","detach","min","Number","MAX_SAFE_INTEGER","max","MIN_SAFE_INTEGER","Math","range","from","utc","to","setTime","Plots","purge","innerHTML","resize","dataList","target","dmapping","indexForSeries","series","xOrY","datapoints","j","seriesName","dS","message","push","Object","keys","map","v","key","missing","val","isString","isBoolean","dX","dY","dZ","dC","dT","scope","elem","attrs","ctrl","find","evt","txt","forEach","when","templateUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACQA,sB,kBAAAA,gB;;AAEDC,O;;AACAC,Y;;AACAC,a;;AAEKC,Y;;;;;;;;;;;;;;;;;;;;;2BAENC,e;;;AAEJ,iCAAYC,MAAZ,EAAoBC,SAApB,EAA+BC,EAA/B,EAAmCC,UAAnC,EAA+CC,QAA/C,EAAyDC,OAAzD,EAAkEC,OAAlE,EAA2EC,YAA3E,EAAyF;AAAA;;AAAA,wIACjFP,MADiF,EACzEC,SADyE;;AAGvF,gBAAKE,UAAL,GAAkBA,UAAlB;AACA,gBAAKG,OAAL,GAAeA,OAAf;AACA,gBAAKC,YAAL,GAAoBA,YAApB;AACA,gBAAKC,CAAL,GAASN,EAAT;;AAEA,gBAAKO,WAAL,GAAmB,IAAnB;AACA,gBAAKC,UAAL,GAAkB,KAAlB;;AAEA,gBAAKC,QAAL,GAAgBC,EAAE,0CAAF,CAAhB;;AAGA,cAAIC,OAAO;AACTC,qBAAS;AACPC,iBAAG,IADI;AAEPC,iBAAG,IAFI;AAGPC,iBAAG,IAHI;AAIPC,qBAAO,IAJA;AAKPC,oBAAM;AALC,aADA;AAQTC,sBAAU;AACRC,oBAAM,SADE;AAERC,oBAAM,eAFE;AAGRC,8BAAgB,KAHR;AAIRC,0BAAY,KAJJ;AAKRC,oBAAM;AACJP,uBAAQ,SADJ;AAEJQ,uBAAQ,CAFJ;AAGJC,sBAAQ,OAHJ;AAIJC,uBAAQ;AAJJ,eALE;AAWRC,sBAAQ;AACNV,sBAAM,EADA;AAENW,wBAAQ,QAFF;AAGNZ,uBAAO,SAHD;AAINa,4BAAY,QAJN;AAKNC,0BAAU,UALJ;AAMNC,yBAAS,CANH;AAONC,yBAAS,GAPH;AAQNT,sBAAM;AACJP,yBAAO,MADH;AAEJQ,yBAAO;AAFH,iBARA;AAYNS,2BAAW;AAZL,eAXA;AAyBRC,6BAAe,EAzBP;AA0BRC,4BAAc;AA1BN,aARD;AAoCTC,oBAAQ;AACNC,wBAAU,KADJ;AAENC,0BAAY,KAFN;AAGNC,sBAAQ,EAAC,eAAe,GAAhB,EAHF;AAINC,wBAAU,OAJJ,EAIa;AACnBC,yBAAW,SALL;AAMNC,4BAAc,SANR;AAONC,6BAAe,eAPT,EAO0B;AAChCC,oBAAM;AACJ5B,uBAAO,SADH;AAEJ6B,wBAAQ;AAFJ,eARA;AAYNC,sBAAQ;AACNC,mBAAG,CADG;AAENC,mBAAG,EAFG;AAGNC,mBAAG,EAHG;AAINC,mBAAG;AAJG,eAZF;AAkBNC,qBAAO;AACLC,0BAAU,IADL;AAELC,0BAAU,KAFL;AAGLlC,sBAAM,QAHD;AAILmC,2BAAW,SAJN;AAKLC,2BAAW,QALN,CAKe;AALf,eAlBD;AAyBNC,qBAAO;AACLJ,0BAAU,IADL;AAELC,0BAAU,KAFL;AAGLlC,sBAAM,QAHD;AAILmC,2BAAW,SAJN;AAKLC,2BAAW,QALN,CAKe;AALf,eAzBD;AAgCNE,qBAAO;AACLN,uBAAM,EAACO,OAAO,QAAR,EADD;AAELF,uBAAM,EAACE,OAAO,QAAR,EAFD;AAGLC,uBAAM,EAACD,OAAO,QAAR;AAHD;AAhCD;AApCC,WAAX;;AA4EA;AACA,gBAAKE,KAAL,CAAWC,OAAX,GAAqBnD,EAAEoD,MAAF,CAAS,IAAT,EAAenD,IAAf,EAAqB,MAAKiD,KAAL,CAAWC,OAAhC,CAArB;;AAEA,cAAIE,MAAM,MAAKH,KAAL,CAAWC,OAArB;AACA,gBAAKG,KAAL,GAAa,EAAb;AACA,gBAAK5B,MAAL,GAAc1B,EAAEoD,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmB,MAAKF,KAAL,CAAWC,OAAX,CAAmBzB,MAAtC,CAAd;;AAEA,gBAAK6B,MAAL,CAAYC,EAAZ,CAAe,gBAAf,EAAiC,MAAKC,cAAL,CAAoBC,IAApB,OAAjC;AACA,gBAAKH,MAAL,CAAYC,EAAZ,CAAe,QAAf,EAAyB,MAAKG,QAAL,CAAcD,IAAd,OAAzB;AACA,gBAAKH,MAAL,CAAYC,EAAZ,CAAe,eAAf,EAAgC,MAAKI,cAAL,CAAoBF,IAApB,OAAhC;AACA,gBAAKH,MAAL,CAAYC,EAAZ,CAAe,YAAf,EAA6B,MAAKK,WAAL,CAAiBH,IAAjB,OAA7B;AACA,gBAAKH,MAAL,CAAYC,EAAZ,CAAe,mBAAf,EAAoC,MAAKM,iBAAL,CAAuBJ,IAAvB,OAApC;AACA,gBAAKH,MAAL,CAAYC,EAAZ,CAAe,SAAf,EAA0B,MAAKO,SAAL,CAAeL,IAAf,OAA1B;;AAEAzE,kBAAQ+E,OAAR,CAAgBvE,OAAhB,EAAyBiE,IAAzB,CAA8B,QAA9B,EAAwC,MAAKO,QAAL,CAAcP,IAAd,OAAxC;AAxGuF;AAyGxF;;;;qCAEU;AACT,iBAAK7D,WAAL,GAAmB,IAAnB;AACD;;;sCAEWqE,G,EAAK;AACf,iBAAKC,UAAL,GAAkB,EAAlB;AACA,iBAAKC,MAAL,CAAY,EAAZ;AACAC,oBAAQC,GAAR,CAAY,aAAZ,EAA2BJ,GAA3B;AACD;;;sCAEW;AACV,gBAAG,KAAKK,KAAL,IAAc,KAAKzE,UAAtB,EAAkC;AAChCZ,qBAAOsF,MAAP,CAAc,KAAKD,KAAnB;AACD;AACF;;;2CAEgB;AACf,iBAAKE,YAAL,CAAkB,SAAlB,EAA6B,oDAA7B,EAAkF,CAAlF;AACF;AACE,iBAAKC,OAAL;AACA,iBAAKC,IAAL,GAAY;AACVzD,sBAAQ,KAAKvB,YAAL,CAAkBiF,UAAlB,CAA6B,EAACC,OAAO,KAAK3B,KAAL,CAAWC,OAAX,CAAmB3C,QAAnB,CAA4BS,MAA5B,CAAmCC,MAA3C,EAA7B;AADE,aAAZ;AAGA,iBAAK4D,WAAL,GAAmB,CAAnB,CAPe,CAOO;;AAEtB,gBAAIzB,MAAM,KAAKH,KAAL,CAAWC,OAArB;AACA,iBAAK4B,IAAL,GAAY,CACV,EAAEC,MAAM,QAAR,EAAkBC,KAAK,CAAvB,EAA0BC,QAAQ7B,IAAI3B,MAAJ,CAAWe,KAA7C,EAAoD0C,QAAQ,gBAACC,IAAD,EAAU;AAAE,oBAAGA,IAAH,EAAS;AAAE/B,sBAAInD,OAAJ,CAAYC,CAAZ,GAAciF,IAAd;AAAqB,iBAAC,OAAO/B,IAAInD,OAAJ,CAAYC,CAAnB;AAAuB,eAAhI,EADU,EAEV,EAAE6E,MAAM,QAAR,EAAkBC,KAAK,CAAvB,EAA0BC,QAAQ7B,IAAI3B,MAAJ,CAAWoB,KAA7C,EAAoDqC,QAAQ,gBAACC,IAAD,EAAU;AAAE,oBAAGA,IAAH,EAAS;AAAE/B,sBAAInD,OAAJ,CAAYE,CAAZ,GAAcgF,IAAd;AAAqB,iBAAC,OAAO/B,IAAInD,OAAJ,CAAYE,CAAnB;AAAuB,eAAhI,EAFU,EAGV,EAAE4E,MAAM,QAAR,EAAkBC,KAAK,CAAvB,EAA0BC,QAAQ7B,IAAI3B,MAAJ,CAAWoB,KAA7C,EAAoDqC,QAAQ,gBAACC,IAAD,EAAU;AAAE,oBAAGA,IAAH,EAAS;AAAE/B,sBAAInD,OAAJ,CAAYG,CAAZ,GAAc+E,IAAd;AAAqB,iBAAC,OAAO/B,IAAInD,OAAJ,CAAYG,CAAnB;AAAuB,eAAhI,EAHU,CAAZ;AAKD;;;wCAEa0E,I,EAAM;AAClB,gBAAGA,KAAKE,GAAL,IAAU,CAAb,EAAgB;AACd,qBAAO,KAAK/B,KAAL,CAAWC,OAAX,CAAmB3C,QAAnB,CAA4BC,IAA5B,KAAqC,WAA5C;AACD;AACD,mBAAO,IAAP;AACD;;;0CAEe;AACd,iBAAKyC,KAAL,CAAWC,OAAX,CAAmB3C,QAAnB,CAA4BS,MAA5B,CAAmCC,MAAnC,GAA4C,KAAKyD,IAAL,CAAUzD,MAAV,CAAiB2D,KAA7D;AACA,iBAAKQ,eAAL;;AAEAhB,oBAAQC,GAAR,CAAa,KAAKK,IAAL,CAAUzD,MAAvB,EAA+B,KAAKgC,KAAL,CAAWC,OAA1C;AACD;;;8CAEmB,CACnB;;;qCAEU;AAAA;;AACT,gBAAG,CAAC,KAAKrD,UAAT,EAAqB;AACnB,kBAAIwF,IAAI,KAAKpC,KAAL,CAAWC,OAAX,CAAmB3C,QAA3B;;AAEA,kBAAI+E,UAAU;AACZC,0BAAU,KADE;AAEZC,6BAAa,KAFD;AAGZ9E,gCAAgB2E,EAAE3E,cAHN;AAIZ+E,wCAAwB,CAAC,iBAAD,CAJZ,CAIgC;AAJhC,eAAd;;AAOA,kBAAIC,OAAO,CAAC,KAAKrC,KAAN,CAAX;AACA,kBAAI,KAAKA,KAAL,CAAWsC,WAAX,KAA2BC,KAA/B,EAAsC;AACpCF,uBAAO,KAAKrC,KAAZ;AACD;;AAED,kBAAIwC,OAAO,KAAKvB,KAAL,CAAWwB,qBAAX,EAAX;;AAEA,kBAAIC,MAAM,KAAKtE,MAAf;AACA,mBAAKA,MAAL,GAAc1B,EAAEoD,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmB,KAAKF,KAAL,CAAWC,OAAX,CAAmBzB,MAAtC,CAAd;AACA,mBAAKA,MAAL,CAAYuE,MAAZ,GAAqB,KAAKA,MAA1B;AACA,mBAAKvE,MAAL,CAAYZ,KAAZ,GAAoBgF,KAAKhF,KAAzB;AACA,mBAAKY,MAAL,CAAYE,UAAZ,GAAyB0D,EAAE1E,UAA3B;AACA,kBAAGoF,GAAH,EAAQ;AACN,qBAAKtE,MAAL,CAAYe,KAAZ,CAAkBO,KAAlB,GAA0BgD,IAAIvD,KAAJ,CAAUO,KAApC;AACA,qBAAKtB,MAAL,CAAYoB,KAAZ,CAAkBE,KAAlB,GAA0BgD,IAAIlD,KAAJ,CAAUE,KAApC;AACD;;AAEDqB,sBAAQC,GAAR,CAAYqB,IAAZ;AACAzG,qBAAOgH,OAAP,CAAe,KAAK3B,KAApB,EAA2BoB,IAA3B,EAAiC,KAAKjE,MAAtC,EAA8C6D,OAA9C;;AAEAI,qBAAO,CAAC,KAAKrC,KAAN,CAAP;AACA,kBAAI,KAAKA,KAAL,CAAWsC,WAAX,KAA2BC,KAA/B,EAAsC;AACpCF,uBAAO,KAAKrC,KAAL,CAAW,CAAX,CAAP;AACD;;AAED,mBAAKiB,KAAL,CAAWf,EAAX,CAAc,cAAd,EAA8B,UAACmC,IAAD,EAAU;AACtC,qBAAI,IAAIQ,IAAE,CAAV,EAAaA,IAAIR,KAAKS,MAAL,CAAYC,MAA7B,EAAqCF,GAArC,EAAyC;AACvC,sBAAIlB,MAAMU,KAAKS,MAAL,CAAYD,CAAZ,EAAeG,WAAzB;AACA,sBAAIC,KAAK,OAAKjD,KAAL,CAAWiD,EAAX,CAActB,GAAd,CAAT;AACD;AACC,sBAAIuB,MAAMb,KAAKS,MAAL,CAAYD,CAAZ,EAAehG,CAAf,CAAiBsG,WAAjB,CAA6B,CAA7B,IAAkC,IAAlC,GAAuCd,KAAKS,MAAL,CAAYD,CAAZ,EAAe/F,CAAf,CAAiBqG,WAAjB,CAA6B,CAA7B,CAAjD;AACA,yBAAKlH,UAAL,CAAgBmH,QAAhB,CAAyB,eAAzB,EAA0C,CAACF,GAAD,EAAM,OAAO,OAAKG,SAAL,CAAeC,UAAf,CAA0B5H,OAAOuH,EAAP,CAA1B,CAAb,CAA1C;AACD;AACF,eARD;;AAUA,kBAAG,KAAH,EAAU;AACR,qBAAKhC,KAAL,CAAWf,EAAX,CAAc,cAAd,EAA8B,UAACmC,IAAD,EAAOkB,GAAP,EAAe;AAC3CxC,0BAAQC,GAAR,CAAa,UAAb,EAAyBqB,IAAzB,EAA+BkB,GAA/B,EAAoC,OAAKC,KAAzC;AACA,sBAAGnB,KAAKS,MAAL,CAAYC,MAAZ,GAAmB,CAAtB,EAAyB;AACvB,wBAAIpB,MAAM,CAAV;AACA,wBAAI8B,KAAKpB,KAAKS,MAAL,CAAYnB,GAAZ,CAAT;;AAEA,wBAAI+B,OAAO,qCAAoCD,GAAGT,WAAvC,GAAoD,QAA/D;AACAU,4BAAQ,UAAR;AACAA,4BAAQD,GAAG5G,CAAH,GAAO,IAAP,GAAY4G,GAAG3G,CAAvB;AACA4G,4BAAQ,WAAR;;AAEA,2BAAKjH,QAAL,CAAckH,IAAd,CAAoBD,IAApB,EAA2BE,QAA3B,CAAqC,OAAKJ,KAAL,CAAWK,KAAX,GAAmB,EAAxD,EAA4D,OAAKL,KAAL,CAAWM,KAAvE;AACD;AACF,iBAbD,EAaG5D,EAbH,CAaM,gBAbN,EAawB,UAACmC,IAAD,EAAU;AAChC,yBAAK5F,QAAL,CAAcsH,MAAd;AACD,iBAfD;AAgBD;;AAED,mBAAK9C,KAAL,CAAWf,EAAX,CAAc,iBAAd,EAAkC,UAACmC,IAAD,EAAU;;AAE1C,oBAAGA,KAAKS,MAAL,CAAYC,MAAZ,IAAsB,CAAzB,EAA4B;AAC1BhC,0BAAQC,GAAR,CAAa,kBAAb,EAAiCqB,IAAjC;AACA;AACD;;AAEDtB,wBAAQC,GAAR,CAAa,UAAb,EAAyBqB,IAAzB;;AAEA,oBAAI2B,MAAMC,OAAOC,gBAAjB;AACA,oBAAIC,MAAMF,OAAOG,gBAAjB;;AAEA,qBAAI,IAAIvB,IAAE,CAAV,EAAaA,IAAIR,KAAKS,MAAL,CAAYC,MAA7B,EAAqCF,GAArC,EAAyC;AACvC,sBAAIlB,MAAMU,KAAKS,MAAL,CAAYD,CAAZ,EAAeG,WAAzB;AACA,sBAAIC,KAAK,OAAKjD,KAAL,CAAWiD,EAAX,CAActB,GAAd,CAAT;AACAqC,wBAAMK,KAAKL,GAAL,CAAUA,GAAV,EAAef,EAAf,CAAN;AACAkB,wBAAME,KAAKF,GAAL,CAAUA,GAAV,EAAelB,EAAf,CAAN;AACD;;AAEDe,uBAAO,IAAP;AACAG,uBAAO,IAAP;;AAEA,oBAAIG,QAAQ,EAACC,MAAM7I,OAAO8I,GAAP,CAAWR,GAAX,CAAP,EAAwBS,IAAI/I,OAAO8I,GAAP,CAAWL,GAAX,CAA5B,EAAZ;;AAEApD,wBAAQC,GAAR,CAAa,aAAb,EAA4BgD,GAA5B,EAAiCG,GAAjC,EAAsC9B,KAAKS,MAAL,CAAYC,MAAlD,EAA0DuB,KAA1D;;AAEA,uBAAKlI,OAAL,CAAasI,OAAb,CAAqBJ,KAArB;;AAEA;AACA,oBAAG,OAAKrD,KAAR,EAAe;AACbrF,yBAAO+I,KAAP,CAAaC,KAAb,CAAmB,OAAK3D,KAAxB;AACA,yBAAKA,KAAL,CAAW4D,SAAX,GAAuB,EAAvB;AACA,yBAAKrI,UAAL,GAAkB,KAAlB;AACD;AACF,eAlCD;AAmCD,aAnGD,MAoGK;AACHZ,qBAAOsF,MAAP,CAAc,KAAKD,KAAnB;AACD;;AAED,gBAAG,KAAK1E,WAAL,IAAoB,KAAK0E,KAAzB,IAAkC,KAAK7C,MAA1C,EAAkD;AAChD,kBAAIoE,OAAO,KAAKvB,KAAL,CAAWwB,qBAAX,EAAX;AACA,mBAAKrE,MAAL,CAAYZ,KAAZ,GAAoBgF,KAAKhF,KAAzB;AACA5B,qBAAO+I,KAAP,CAAaG,MAAb,CAAoB,KAAK7D,KAAzB;AACD;AACD,iBAAK1E,WAAL,GAAmB,KAAnB;AACA,iBAAKC,UAAL,GAAkB,IAAlB;AACD;;;yCAEcuI,Q,EAAU;AACvB,iBAAK/E,KAAL,CAAWnD,CAAX,GAAe,EAAf;AACA,iBAAKmD,KAAL,CAAWlD,CAAX,GAAe,EAAf;AACA,iBAAKkD,KAAL,CAAWjD,CAAX,GAAe,EAAf;;AAEA,iBAAKsF,IAAL,GAAY,EAAZ;AACA,gBAAG0C,SAAShC,MAAT,GAAkB,CAArB,EAAwB;AACtBhC,sBAAQC,GAAR,CAAa,SAAb,EAAwB+D,QAAxB;AACD,aAFD,MAGK,IAAI,KAAKnF,KAAL,CAAWC,OAAX,CAAmB3C,QAAnB,CAA4BgB,aAA5B,CAA0C6E,MAA1C,GAAmD,CAAvD,EAA0D;AAC7D,kBAAIhD,MAAM,KAAKH,KAAL,CAAWC,OAArB;AACA,kBAAIjD,UAAUmD,IAAInD,OAAlB;AACA,mBAAKyF,IAAL,CAAU,OAAV,IAAqB,CAArB;AACA,mBAAKA,IAAL,CAAU,QAAV,IAAsB,CAAtB;AACA,mBAAI,IAAIQ,IAAE,CAAV,EAAaA,IAAEkC,SAAShC,MAAxB,EAAgCF,GAAhC,EAAqC;AACnC,qBAAKR,IAAL,CAAU0C,SAASlC,CAAT,EAAYmC,MAAtB,IAAgC,CAAhC;AACD;;AAED,kBAAG,CAACpI,QAAQC,CAAZ,EAAeD,QAAQC,CAAR,GAAYoI,SAASpI,CAArB;AACf,kBAAG,CAACD,QAAQE,CAAZ,EAAeF,QAAQE,CAAR,GAAYmI,SAASnI,CAArB;;AAEf,kBAAIoI,iBAAiB,CAAC,CAAtB;AACA,mBAAI,IAAIrC,KAAE,CAAV,EAAaA,KAAEkC,SAAShC,MAAxB,EAAgCF,IAAhC,EAAqC;AACnC,oBAAIkC,SAASlC,EAAT,EAAYmC,MAAZ,IAAsB,KAAKpF,KAAL,CAAWC,OAAX,CAAmB3C,QAAnB,CAA4BgB,aAAtD,EAAqE;AACnEgH,mCAAiBrC,EAAjB;AACD,iBAFD,MAEO,IAAI,CAACjG,QAAQC,CAAb,EAAgB;AACrBD,0BAAQC,CAAR,GAAYkI,SAASlC,EAAT,EAAYmC,MAAxB;AACD,iBAFM,MAEA,IAAI,CAACpI,QAAQE,CAAb,EAAgB;AACrBF,0BAAQE,CAAR,GAAYiI,SAASlC,EAAT,EAAYmC,MAAxB;AACD;AACF;;AAED,kBAAIG,SAAS,EAAb;AACA,mBAAI,IAAItC,MAAE,CAAV,EAAaA,MAAEkC,SAAShC,MAAxB,EAAgCF,KAAhC,EAAqC;AACnC,oBAAIA,OAAKqC,cAAT,EAAyB;AACvB,sBAAIE,OAAO,GAAX;AACA,sBAAIL,SAASlC,GAAT,EAAYmC,MAAZ,IAAsBpI,QAAQE,CAAlC,EAAqC;AACnCsI,2BAAO,GAAP;AACD;AACD,sBAAIC,aAAaN,SAASlC,GAAT,EAAYwC,UAA7B;AACA,uBAAI,IAAIC,IAAE,CAAV,EAAaA,IAAED,WAAWtC,MAA1B,EAAkCuC,GAAlC,EAAuC;AACrC,wBAAIC,aAAaR,SAASG,cAAT,EAAyBG,UAAzB,CAAoCC,CAApC,EAAuC,CAAvC,CAAjB;AACA,wBAAI,EAAEC,cAAcJ,MAAhB,CAAJ,EAA6B;AAC3BA,6BAAOI,UAAP,IAAqB,EAAE1I,GAAG,EAAL,EAASC,GAAG,EAAZ,EAAgBgF,MAAMyD,UAAtB,EAArB;AACAJ,6BAAOI,UAAP,EAAmB,QAAnB,IAA+B7I,EAAEoD,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmBC,IAAI7C,QAAJ,CAAaS,MAAhC,CAA/B;AACAwH,6BAAOI,UAAP,EAAmB,MAAnB,IAA6B7I,EAAEoD,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmBC,IAAI7C,QAAJ,CAAaK,IAAhC,CAA7B;AACA,6BAAO4H,OAAOI,UAAP,EAAmB,MAAnB,EAA2B,OAA3B,CAAP;AACA,6BAAOJ,OAAOI,UAAP,EAAmB,QAAnB,EAA6B,OAA7B,CAAP;AACA,0BAAG3I,QAAQK,IAAX,EAAiB;AACf,4BAAIuI,KAAK,KAAKnD,IAAL,CAAUzF,QAAQK,IAAlB,CAAT;AACA,4BAAG,CAACuI,EAAJ,EAAQ;AACN,gCAAM,EAAEC,SAAS,0BAAwB7I,QAAQK,IAA3C,EAAN;AACD;AACDkI,+BAAOI,UAAP,EAAmB,QAAnB,EAA6BtI,IAA7B,GAAoCuI,GAAG1C,MAAvC;AACD;AACF;AACDqC,2BAAOI,UAAP,EAAmBH,IAAnB,EAAyBM,IAAzB,CAA8BL,WAAWC,CAAX,EAAc,CAAd,CAA9B;AACD;AACF;AACF;;AAED,mBAAKtF,KAAL,GAAa2F,OAAOC,IAAP,CAAYT,MAAZ,EAAoBU,GAApB,CAAwB,UAASC,CAAT,EAAY;AAAE,uBAAOX,OAAOW,CAAP,CAAP;AAAmB,eAAzD,CAAb;AACD,aArDI,MAsDA;AACH,mBAAK9F,KAAL,GAAa,EAAb;AACA,kBAAIiF,YAAW;AACbpI,mBAAE,IADW;AAEbC,mBAAE,IAFW;AAGbC,mBAAE;AAHW,eAAf;;AAMH;AACG,kBAAIgD,OAAM,KAAKH,KAAL,CAAWC,OAArB;AACA,kBAAIjD,WAAUmD,KAAInD,OAAlB;AACA,kBAAImJ,MAAM;AACRjE,sBAAM,OADE;AAER3E,sBAAM,IAFE;AAGR6I,yBAAS,CAHD;AAIRrE,qBAAK,CAAC,CAJE;AAKRmB,wBAAQ;AALA,eAAV;AAOA,kBAAInB,MAAM;AACRG,sBAAM,QADE;AAER3E,sBAAM,QAFE;AAGR6I,yBAAS,CAHD;AAIRrE,qBAAK,CAAC,CAJE;AAKRmB,wBAAQ;AALA,eAAV;AAOA,mBAAKT,IAAL,CAAU0D,IAAIjE,IAAd,IAAsBiE,GAAtB;AACA,mBAAK1D,IAAL,CAAUV,IAAIG,IAAd,IAAsBH,GAAtB;AACA,mBAAI,IAAIkB,MAAE,CAAV,EAAaA,MAAEkC,SAAShC,MAAxB,EAAgCF,KAAhC,EAAqC;AACnC,oBAAIwC,cAAaN,SAASlC,GAAT,EAAYwC,UAA7B;AACA,oBAAGA,YAAWtC,MAAX,GAAoB,CAAvB,EAA0B;AACxB,sBAAIkD,MAAM;AACRnE,0BAAMiD,SAASlC,GAAT,EAAYmC,MADV;AAER7H,0BAAM,QAFE;AAGR6I,6BAAS,CAHD;AAIRrE,yBAAKkB,GAJG;AAKRC,4BAAQ;AALA,mBAAV;AAOA,sBAAGrH,EAAEyK,QAAF,CAAWb,YAAW,CAAX,EAAc,CAAd,CAAX,CAAH,EAAiC;AAC/BY,wBAAI9I,IAAJ,GAAW,QAAX;AACD,mBAFD,MAGK,IAAG1B,EAAE0K,SAAF,CAAYd,YAAW,CAAX,EAAc,CAAd,CAAZ,CAAH,EAAkC;AACrCY,wBAAI9I,IAAJ,GAAW,SAAX;AACD;;AAED;AACA,sBAAG0F,OAAG,CAAN,EAAS;AACPoC,8BAASpI,CAAT,GAAaoJ,IAAInE,IAAjB;AACD,mBAFD,MAGK,IAAGe,OAAG,CAAN,EAAS;AACZoC,8BAASnI,CAAT,GAAamJ,IAAInE,IAAjB;AACD,mBAFI,MAGA,IAAGe,OAAG,CAAN,EAAS;AACZoC,8BAASlI,CAAT,GAAakJ,IAAInE,IAAjB;AACD;;AAED,uBAAKO,IAAL,CAAU4D,IAAInE,IAAd,IAAsBmE,GAAtB;AACA,sBAAGF,IAAIjD,MAAJ,CAAWC,MAAX,IAAmB,CAAtB,EAAyB;AACvB,yBAAI,IAAIuC,IAAE,CAAV,EAAaA,IAAED,YAAWtC,MAA1B,EAAkCuC,GAAlC,EAAuC;AACrCS,0BAAIjD,MAAJ,CAAW4C,IAAX,CAAiBL,YAAWC,CAAX,EAAc,CAAd,CAAjB;AACAW,0BAAInD,MAAJ,CAAW4C,IAAX,CAAiBL,YAAWC,CAAX,EAAc,CAAd,CAAjB;AACA3D,0BAAImB,MAAJ,CAAW4C,IAAX,CAAiBJ,CAAjB;AACD;AACF,mBAND,MAOK;AACH,yBAAI,IAAIA,IAAE,CAAV,EAAaA,IAAED,YAAWtC,MAA1B,EAAkCuC,GAAlC,EAAuC;AACrC,0BAAGA,KAAKS,IAAIjD,MAAJ,CAAWC,MAAnB,EAA4B;AAC1B;AACD;AACD;AACA,0BAAGgD,IAAIjD,MAAJ,CAAWwC,CAAX,KAAiBD,YAAWC,CAAX,EAAc,CAAd,CAApB,EAAsC;AACpCW,4BAAInD,MAAJ,CAAW4C,IAAX,CAAiBL,YAAWC,CAAX,EAAc,CAAd,CAAjB;AACD,uBAFD,MAGK;AACHW,4BAAID,OAAJ,GAAcC,IAAID,OAAJ,GAAY,CAA1B;AACD;AACF;AACF;AACF;AACF;;AAED;AACA,kBAAG,CAACpJ,SAAQC,CAAZ,EAAeD,SAAQC,CAAR,GAAYoI,UAASpI,CAArB;AACf,kBAAG,CAACD,SAAQE,CAAZ,EAAeF,SAAQE,CAAR,GAAYmI,UAASnI,CAArB;AACf,kBAAG,CAACF,SAAQG,CAAZ,EAAeH,SAAQG,CAAR,GAAYkI,UAASlI,CAArB;;AAEhB;;AAEC,kBAAIqJ,KAAK,KAAK/D,IAAL,CAAUzF,SAAQC,CAAlB,CAAT;AACA,kBAAIwJ,KAAK,KAAKhE,IAAL,CAAUzF,SAAQE,CAAlB,CAAT;AACA,kBAAIwJ,KAAK,IAAT;AACA,kBAAIC,KAAK,IAAT;AACA,kBAAIf,KAAK,IAAT;AACA,kBAAIgB,KAAK,IAAT;;AAEA,kBAAG,CAACJ,EAAJ,EAAQ;AACN,sBAAM,EAAEX,SAAS,uBAAqB7I,SAAQC,CAAxC,EAAN;AACD;AACD,kBAAG,CAACwJ,EAAJ,EAAQ;AACN,sBAAM,EAAEZ,SAAS,uBAAqB7I,SAAQE,CAAxC,EAAN;AACD;;AAGD,mBAAKkD,KAAL,CAAWiD,EAAX,GAAgB8C,IAAIjD,MAApB;AACA,mBAAK9C,KAAL,CAAWnD,CAAX,GAAeuJ,GAAGtD,MAAlB;AACA,mBAAK9C,KAAL,CAAWlD,CAAX,GAAeuJ,GAAGvD,MAAlB;;AAEA,kBAAG/C,KAAI7C,QAAJ,CAAaC,IAAb,IAAqB,WAAxB,EAAqC;AACnCmJ,qBAAK,KAAKjE,IAAL,CAAUzF,SAAQG,CAAlB,CAAL;AACA,oBAAG,CAACuJ,EAAJ,EAAQ;AACN,wBAAM,EAAEb,SAAS,uBAAqB7I,SAAQG,CAAxC,EAAN;AACD;AACD,qBAAKqB,MAAL,CAAYqB,KAAZ,CAAkBN,KAAlB,CAAwBO,KAAxB,GAAgC0G,GAAGtE,IAAnC;AACA,qBAAK1D,MAAL,CAAYqB,KAAZ,CAAkBD,KAAlB,CAAwBE,KAAxB,GAAgC2G,GAAGvE,IAAnC;AACA,qBAAK1D,MAAL,CAAYqB,KAAZ,CAAkBE,KAAlB,CAAwBD,KAAxB,GAAgC4G,GAAGxE,IAAnC;;AAEA,qBAAK9B,KAAL,CAAWjD,CAAX,GAAeuJ,GAAGxD,MAAlB;AACA/B,wBAAQC,GAAR,CAAa,IAAb,EAAmB,KAAK5C,MAAxB;AACD,eAXD,MAYK;AACH,qBAAKA,MAAL,CAAYe,KAAZ,CAAkBO,KAAlB,GAA0B0G,GAAGtE,IAA7B;AACA,qBAAK1D,MAAL,CAAYoB,KAAZ,CAAkBE,KAAlB,GAA0B2G,GAAGvE,IAA7B;AACD;;AAGD,mBAAK9B,KAAL,CAAWrC,MAAX,GAAoBjB,EAAEoD,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmBC,KAAI7C,QAAJ,CAAaS,MAAhC,CAApB;AACA,mBAAKqC,KAAL,CAAWzC,IAAX,GAAkBb,EAAEoD,MAAF,CAAS,IAAT,EAAe,EAAf,EAAmBC,KAAI7C,QAAJ,CAAaK,IAAhC,CAAlB;;AAEA,kBAAGX,SAAQK,IAAX,EAAiB;AACfuI,qBAAK,KAAKnD,IAAL,CAAUzF,SAAQK,IAAlB,CAAL;AACA,oBAAG,CAACuI,EAAJ,EAAQ;AACN,wBAAM,EAAEC,SAAS,0BAAwB7I,SAAQK,IAA3C,EAAN;AACD;AACD,qBAAK+C,KAAL,CAAWrC,MAAX,CAAkBV,IAAlB,GAAyBuI,GAAG1C,MAA5B;AACD;;AAED;AACA,kBAAI/C,KAAI7C,QAAJ,CAAaiB,YAAb,IAA6B,MAAjC,EAA0C;AACxC,oBAAG,CAACvB,SAAQI,KAAZ,EAAmB;AACjBJ,2BAAQI,KAAR,GAAgB2E,IAAIG,IAApB;AACD;AACDyE,qBAAK,KAAKlE,IAAL,CAAUzF,SAAQI,KAAlB,CAAL;AACA,oBAAG,CAACuJ,EAAJ,EAAQ;AACN,wBAAM,EAAEd,SAAS,2BAAyB7I,SAAQI,KAA5C,EAAN;AACD;AACD,qBAAKgD,KAAL,CAAWrC,MAAX,CAAkBX,KAAlB,GAA0BuJ,GAAGzD,MAA7B;AACD;;AAED/B,sBAAQC,GAAR,CAAa,OAAb,EAAsB,KAAKhB,KAA3B;AACD;AACD,iBAAKxD,UAAL,GAAkB,KAAlB;AACA,iBAAKsE,MAAL;AACD;;;4CAEiB;AAChBC,oBAAQC,GAAR,CAAa,mBAAb;AACA,gBAAG,KAAKC,KAAR,EAAe;AACbrF,qBAAO+I,KAAP,CAAaC,KAAb,CAAmB,KAAK3D,KAAxB;AACA,mBAAKA,KAAL,CAAW4D,SAAX,GAAuB,EAAvB;AACA,mBAAKrI,UAAL,GAAkB,KAAlB;AACD;;AAED,gBAAIuD,MAAM,KAAKH,KAAL,CAAWC,OAArB;;AAEA,gBAAI,KAAKG,KAAL,CAAWsC,WAAX,KAA2BC,KAA/B,EAAsC;AACpC,mBAAI,IAAIM,IAAE,CAAV,EAAaA,IAAE,KAAK7C,KAAL,CAAW+C,MAA1B,EAAkCF,GAAlC,EAAuC;AACrC,qBAAK7C,KAAL,CAAW6C,CAAX,EAAc1F,IAAd,GAAqB4C,IAAI7C,QAAJ,CAAaC,IAAlC;AACA,qBAAK6C,KAAL,CAAW6C,CAAX,EAAczF,IAAd,GAAqB2C,IAAI7C,QAAJ,CAAaE,IAAlC;AACD;AACF,aALD,MAKO;AACL,mBAAK4C,KAAL,CAAW7C,IAAX,GAAkB4C,IAAI7C,QAAJ,CAAaC,IAA/B;AACA,mBAAK6C,KAAL,CAAW5C,IAAX,GAAkB2C,IAAI7C,QAAJ,CAAaE,IAA/B;AACD;;AAED,gBAAIqE,OAAO,CAAE,KAAK7B,KAAL,CAAWC,OAAX,CAAmBzB,MAAnB,CAA0Be,KAA5B,EAAmC,KAAKS,KAAL,CAAWC,OAAX,CAAmBzB,MAAnB,CAA0BoB,KAA7D,CAAX;AACA,iBAAI,IAAIqD,MAAE,CAAV,EAAaA,MAAEpB,KAAKsB,MAApB,EAA4BF,KAA5B,EAAiC;AAC/B,kBAAIpB,KAAKoB,GAAL,EAAQtD,SAAR,KAAsB,SAA1B,EAAsC;AACpC,oBAAIkC,KAAKoB,GAAL,EAAQyB,KAAR,IAAiB,IAArB,EAA2B;AACzB7C,uBAAKoB,GAAL,EAAQyB,KAAR,GAAgB,CAAC,CAAD,EAAI,IAAJ,CAAhB;AACD;AACF,eAJD,MAKK;AACH7C,qBAAKoB,GAAL,EAAQyB,KAAR,GAAgB,IAAhB;AACD;AACF;AACD,iBAAKlD,OAAL;AACD;;;+BAEIqF,K,EAAOC,I,EAAMC,K,EAAOC,I,EAAM;AAAA;;AAC7B,iBAAK3F,KAAL,GAAayF,KAAKG,IAAL,CAAU,cAAV,EAA0B,CAA1B,CAAb;AACA,iBAAKrK,UAAL,GAAkB,KAAlB;AACAkK,iBAAKxG,EAAL,CAAS,WAAT,EAAsB,UAAC4G,GAAD,EAAS;AAC7B,qBAAKtD,KAAL,GAAasD,GAAb;AACD,aAFD;AAGD;;;0CAMD;AAAA;;AACE,gBAAIC,MAAM,CACd,QADc,EACL,aADK,EACS,YADT,EACsB,iBADtB,EAEd,QAFc,EAEL,aAFK,EAES,YAFT,EAEsB,iBAFtB,EAGd,SAHc,EAGJ,cAHI,EAId,aAJc,EAIA,kBAJA,EAKd,OALc,EAKN,YALM,EAMd,WANc,EAMF,gBANE,EAOd,GAPc,EAOV,QAPU,EAOD,OAPC,EAOO,YAPP,EAQd,aARc,EASd,kBATc,EAUd,iBAVc,EAWd,sBAXc,EAYd,eAZc,EAad,oBAbc,EAcd,mBAdc,EAed,wBAfc,EAgBd,eAhBc,EAiBd,oBAjBc,EAkBd,mBAlBc,EAmBd,wBAnBc,EAoBd,gBApBc,EAqBd,qBArBc,EAsBd,oBAtBc,EAuBd,yBAvBc,EAwBd,aAxBc,EAyBd,kBAzBc,EA0Bd,iBA1Bc,EA2Bd,sBA3Bc,EA4Bd,aA5Bc,EA6Bd,kBA7Bc,EA8Bd,iBA9Bc,EA+Bd,sBA/Bc,EAgCd,aAhCc,EAiCd,kBAjCc,EAkCd,iBAlCc,EAmCd,sBAnCc,EAoCd,aApCc,EAqCd,kBArCc,EAsCd,iBAtCc,EAuCd,sBAvCc,EAwCd,UAxCc,EAyCd,eAzCc,EA0Cd,cA1Cc,EA2Cd,mBA3Cc,EA4Cd,SA5Cc,EA6Cd,cA7Cc,EA8Cd,aA9Cc,EA+Cd,kBA/Cc,EAgDd,UAhDc,EAiDd,eAjDc,EAkDd,cAlDc,EAmDd,mBAnDc,EAoDd,SApDc,EAqDd,cArDc,EAsDd,aAtDc,EAuDd,kBAvDc,EAwDd,MAxDc,EAyDd,WAzDc,EA0Dd,UA1Dc,EA2Dd,eA3Dc,EA4Dd,UA5Dc,EA6Dd,eA7Dc,EA8Dd,cA9Dc,EA+Dd,mBA/Dc,EAgEd,kBAhEc,EAiEd,uBAjEc,EAkEd,sBAlEc,EAmEd,2BAnEc,EAoEd,oBApEc,EAqEd,yBArEc,EAsEd,wBAtEc,EAuEd,6BAvEc,EAwEd,aAxEc,EAyEd,kBAzEc,EA0Ed,iBA1Ec,EA2Ed,sBA3Ec,EA4Ed,cA5Ec,EA6Ed,mBA7Ec,EA8Ed,kBA9Ec,EA+Ed,uBA/Ec,EAgFd,cAhFc,EAiFd,mBAjFc,EAkFd,kBAlFc,EAmFd,uBAnFc,EAoFd,cApFc,EAqFd,mBArFc,EAsFd,kBAtFc,EAuFd,uBAvFc,EAwFd,WAxFc,EAyFd,gBAzFc,EA0Fd,QA1Fc,EA2Fd,aA3Fc,EA4Fd,cA5Fc,EA6Fd,mBA7Fc,EA8Fd,UA9Fc,EA+Fd,eA/Fc,EAgGd,cAhGc,EAiGd,mBAjGc,EAkGd,UAlGc,EAmGd,eAnGc,EAoGd,eApGc,EAqGd,oBArGc,EAsGd,WAtGc,EAuGd,gBAvGc,EAwGd,YAxGc,EAyGd,iBAzGc,EA0Gd,QA1Gc,EA2Gd,aA3Gc,EA4Gd,UA5Gc,EA6Gd,eA7Gc,EA8Gd,MA9Gc,EA+Gd,WA/Gc,EAgHd,UAhHc,EAiHd,eAjHc,EAkHd,MAlHc,EAmHd,WAnHc,EAoHd,QApHc,EAqHd,aArHc,EAsHd,QAtHc,EAuHd,aAvHc,EAwHd,SAxHc,EAyHd,cAzHc,EA0Hd,SA1Hc,EA2Hd,cA3Hc,EA4Hd,SA5Hc,EA6Hd,cA7Hc,EA8Hd,SA9Hc,EA+Hd,cA/Hc,EAgId,SAhIc,EAiId,cAjIc,CAAV;;AAoIA,gBAAI1F,OAAO,EAAX;AACA5F,cAAEuL,OAAF,CAAUD,GAAV,EAAe,UAACd,GAAD,EAAS;AACtB5E,mBAAKqE,IAAL,CAAW,OAAKrJ,YAAL,CAAkBiF,UAAlB,CAA8B2E,GAA9B,CAAX;AACD,aAFD;AAGA,mBAAO,KAAK3J,CAAL,CAAO2K,IAAP,CAAa5F,IAAb,CAAP;AACD;;;;QAjqB2B7F,gB;;AAmqB9BK,sBAAgBqL,WAAhB,GAA8B,aAA9B;;2BAGErL,e","file":"module.js","sourcesContent":["\nimport {MetricsPanelCtrl} from  'app/plugins/sdk';\n\nimport _ from 'lodash';\nimport moment from 'moment';\nimport angular from 'angular';\n\nimport * as Plotly from './external/plotly';\n\nclass PlotlyPanelCtrl extends MetricsPanelCtrl {\n\n  constructor($scope, $injector, $q, $rootScope, $timeout, $window, timeSrv, uiSegmentSrv) {\n    super($scope, $injector);\n\n    this.$rootScope = $rootScope;\n    this.timeSrv = timeSrv;\n    this.uiSegmentSrv = uiSegmentSrv;\n    this.q = $q;\n\n    this.sizeChanged = true;\n    this.initalized = false;\n\n    this.$tooltip = $('<div id=\"tooltip\" class=\"graph-tooltip\">');\n\n\n    var dcfg = {\n      mapping: {\n        x: null,\n        y: null,\n        z: null,\n        color: null,\n        size: null,\n      },\n      settings: {\n        type: 'scatter',\n        mode: 'lines+markers',\n        displayModeBar: false,\n        showLegend: false,\n        line: {\n          color : '#005f81',\n          width : 6,\n          dash  : 'solid',\n          shape : 'linear'\n        },\n        marker: {\n          size: 30,\n          symbol: 'circle',\n          color: '#33B5E5',\n          colorscale: 'YIOrRd',\n          sizemode: 'diameter',\n          sizemin: 3,\n          sizeref: 0.2,\n          line: {\n            color: '#DDD',\n            width: 0\n          },\n          showscale: true\n        },\n        groupToSeries: '',\n        color_option: 'ramp'\n      },\n      layout: {\n        autosize: false,\n        showlegend: false,\n        legend: {\"orientation\": \"v\"},\n        dragmode: 'lasso', // (enumerated: \"zoom\" | \"pan\" | \"select\" | \"lasso\" | \"orbit\" | \"turntable\" )\n        hovermode: 'closest',\n        plot_bgcolor: \"#1f1d1d\",\n        paper_bgcolor: 'rgba(0,0,0,0)', // transparent?\n        font: {\n          color: '#D8D9DA',\n          family: '\"Open Sans\", Helvetica, Arial, sans-serif'\n        },\n        margin: {\n          t: 0,\n          b: 45,\n          l: 65,\n          r: 20,\n        },\n        xaxis: {\n          showgrid: true,\n          zeroline: false,\n          type: 'linear',\n          gridcolor: '#444444',\n          rangemode: 'normal' // (enumerated: \"normal\" | \"tozero\" | \"nonnegative\" )\n        },\n        yaxis: {\n          showgrid: true,\n          zeroline: false,\n          type: 'linear',\n          gridcolor: '#444444',\n          rangemode: 'normal' // (enumerated: \"normal\" | \"tozero\" | \"nonnegative\" )\n        },\n        scene: {\n          xaxis:{title: 'X AXIS'},\n          yaxis:{title: 'Y AXIS'},\n          zaxis:{title: 'Z AXIS'},\n        },\n      }\n    };\n\n    // Make sure it has the default settings (may have more!)\n    this.panel.pconfig = $.extend(true, dcfg, this.panel.pconfig );\n\n    var cfg = this.panel.pconfig;\n    this.trace = { };\n    this.layout = $.extend(true, {}, this.panel.pconfig.layout );\n\n    this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\n    this.events.on('render', this.onRender.bind(this));\n    this.events.on('data-received', this.onDataReceived.bind(this));\n    this.events.on('data-error', this.onDataError.bind(this));\n    this.events.on('panel-initialized', this.onPanelInitalized.bind(this));\n    this.events.on('refresh', this.onRefresh.bind(this));\n\n    angular.element($window).bind('resize', this.onResize.bind(this) );\n  }\n\n  onResize() {\n    this.sizeChanged = true;\n  }\n\n  onDataError(err) {\n    this.seriesList = [];\n    this.render([]);\n    console.log(\"onDataError\", err);\n  }\n\n  onRefresh() {\n    if(this.graph && this.initalized) {\n      Plotly.redraw(this.graph);\n    }\n  }\n\n  onInitEditMode() {\n    this.addEditorTab('Display', 'public/plugins/natel-plotly-panel/tab_display.html',2);\n  //  this.editorTabIndex = 1;\n    this.refresh();\n    this.segs = {\n      symbol: this.uiSegmentSrv.newSegment({value: this.panel.pconfig.settings.marker.symbol })\n    };\n    this.subTabIndex = 0; // select the options\n\n    var cfg = this.panel.pconfig;\n    this.axis = [\n      { disp: 'X Axis', idx: 1, config: cfg.layout.xaxis, metric: (name) => { if(name) { cfg.mapping.x=name; } return cfg.mapping.x; }},\n      { disp: 'Y Axis', idx: 2, config: cfg.layout.yaxis, metric: (name) => { if(name) { cfg.mapping.y=name; } return cfg.mapping.y; }},\n      { disp: 'Z Axis', idx: 3, config: cfg.layout.yaxis, metric: (name) => { if(name) { cfg.mapping.z=name; } return cfg.mapping.z; }}\n    ];\n  }\n\n  isAxisVisible(axis) {\n    if(axis.idx==3) {\n      return this.panel.pconfig.settings.type === 'scatter3d';\n    }\n    return true;\n  }\n\n  onSegsChanged() {\n    this.panel.pconfig.settings.marker.symbol = this.segs.symbol.value;\n    this.onConfigChanged();\n\n    console.log( this.segs.symbol, this.panel.pconfig );\n  }\n\n  onPanelInitalized() {\n  }\n\n  onRender() {\n    if(!this.initalized) {\n      var s = this.panel.pconfig.settings;\n\n      var options = {\n        showLink: false,\n        displaylogo: false,\n        displayModeBar: s.displayModeBar,\n        modeBarButtonsToRemove: ['sendDataToCloud'] //, 'select2d', 'lasso2d']\n      }\n\n      var data = [this.trace];\n      if (this.trace.constructor === Array) {\n        data = this.trace;\n      }\n\n      var rect = this.graph.getBoundingClientRect();\n\n      var old = this.layout;\n      this.layout = $.extend(true, {}, this.panel.pconfig.layout );\n      this.layout.height = this.height;\n      this.layout.width = rect.width;\n      this.layout.showlegend = s.showLegend;\n      if(old) {\n        this.layout.xaxis.title = old.xaxis.title;\n        this.layout.yaxis.title = old.yaxis.title;\n      }\n\n      console.log(data);\n      Plotly.newPlot(this.graph, data, this.layout, options);\n\n      data = [this.trace];\n      if (this.trace.constructor === Array) {\n        data = this.trace[0];\n      }\n\n      this.graph.on('plotly_click', (data) => {\n        for(var i=0; i < data.points.length; i++){\n          var idx = data.points[i].pointNumber;\n          var ts = this.trace.ts[idx];\n         // console.log( 'CLICK!!!', ts, data );\n          var msg = data.points[i].x.toPrecision(4) + \", \"+data.points[i].y.toPrecision(4);\n          this.$rootScope.appEvent('alert-success', [msg, '@ ' + this.dashboard.formatDate(moment(ts))]);\n        }\n      });\n\n      if(false) {\n        this.graph.on('plotly_hover', (data, xxx) => {\n          console.log( 'HOVER!!!', data, xxx, this.mouse );\n          if(data.points.length>0) {\n            var idx = 0;\n            var pt = data.points[idx];\n\n            var body = '<div class=\"graph-tooltip-time\">'+ pt.pointNumber +'</div>';\n            body += \"<center>\";\n            body += pt.x + ', '+pt.y;\n            body += \"</center>\";\n\n            this.$tooltip.html( body ).place_tt( this.mouse.pageX + 10, this.mouse.pageY );\n          }\n        }).on('plotly_unhover', (data) => {\n          this.$tooltip.detach();\n        });\n      }\n\n      this.graph.on('plotly_selected',  (data) => {\n\n        if(data.points.length == 0) {\n          console.log( \"Nothign Selected\", data)\n          return;\n        }\n\n        console.log( \"SELECTED\", data)\n\n        var min = Number.MAX_SAFE_INTEGER;\n        var max = Number.MIN_SAFE_INTEGER;\n\n        for(var i=0; i < data.points.length; i++){\n          var idx = data.points[i].pointNumber;\n          var ts = this.trace.ts[idx];\n          min = Math.min( min, ts);\n          max = Math.max( max, ts);\n        }\n\n        min -= 1000;\n        max += 1000;\n\n        var range = {from: moment.utc(min), to: moment.utc(max) };\n\n        console.log( 'SELECTED!!!', min, max, data.points.length, range );\n\n        this.timeSrv.setTime(range);\n\n        // rebuild the graph after query\n        if(this.graph) {\n          Plotly.Plots.purge(this.graph);\n          this.graph.innerHTML = '';\n          this.initalized = false;\n        }\n      });\n    }\n    else {\n      Plotly.redraw(this.graph);\n    }\n\n    if(this.sizeChanged && this.graph && this.layout) {\n      var rect = this.graph.getBoundingClientRect();\n      this.layout.width = rect.width;\n      Plotly.Plots.resize(this.graph);\n    }\n    this.sizeChanged = false;\n    this.initalized = true;\n  }\n\n  onDataReceived(dataList) {\n    this.trace.x = [];\n    this.trace.y = [];\n    this.trace.z = [];\n\n    this.data = {};\n    if(dataList.length < 2) {\n      console.log( \"No data\", dataList );\n    }\n    else if (this.panel.pconfig.settings.groupToSeries.length > 0) {\n      let cfg = this.panel.pconfig;\n      let mapping = cfg.mapping;\n      this.data[\"@time\"] = 1;\n      this.data[\"@index\"] = 1;\n      for(let i=0; i<dataList.length; i++) {\n        this.data[dataList[i].target] = 1;\n      }\n\n      if(!mapping.x) mapping.x = dmapping.x;\n      if(!mapping.y) mapping.y = dmapping.y;\n\n      let indexForSeries = -1;\n      for(let i=0; i<dataList.length; i++) {\n        if (dataList[i].target == this.panel.pconfig.settings.groupToSeries) {\n          indexForSeries = i\n        } else if (!mapping.x) {\n          mapping.x = dataList[i].target;\n        } else if (!mapping.y) {\n          mapping.y = dataList[i].target;\n        }\n      }\n\n      let series = {};\n      for(let i=0; i<dataList.length; i++) {\n        if (i != indexForSeries) {\n          let xOrY = \"x\";\n          if (dataList[i].target == mapping.y) {\n            xOrY = \"y\";\n          }\n          let datapoints = dataList[i].datapoints;\n          for(var j=0; j<datapoints.length; j++) {\n            let seriesName = dataList[indexForSeries].datapoints[j][0];\n            if (!(seriesName in series)) {\n              series[seriesName] = { x: [], y: [], name: seriesName };\n              series[seriesName][\"marker\"] = $.extend(true, {}, cfg.settings.marker);\n              series[seriesName][\"line\"] = $.extend(true, {}, cfg.settings.line);\n              delete series[seriesName][\"line\"][\"color\"]\n              delete series[seriesName][\"marker\"][\"color\"]\n              if(mapping.size) {\n                var dS = this.data[mapping.size];\n                if(!dS) {\n                  throw { message: \"Unable to find Size: \"+mapping.size };\n                }\n                series[seriesName][\"marker\"].size = dS.points;\n              }\n            }\n            series[seriesName][xOrY].push(datapoints[j][0]);\n          }\n        }\n      }\n\n      this.trace = Object.keys(series).map(function(v) { return series[v]; });\n    }\n    else {\n      this.trace = { };\n      let dmapping = {\n        x:null,\n        y:null,\n        z:null\n      };\n\n   //   console.log( \"plotly data\", dataList);\n      let cfg = this.panel.pconfig;\n      let mapping = cfg.mapping;\n      let key = {\n        name: \"@time\",\n        type: 'ms',\n        missing: 0,\n        idx: -1,\n        points: []\n      };\n      let idx = {\n        name: \"@index\",\n        type: 'number',\n        missing: 0,\n        idx: -1,\n        points: []\n      };\n      this.data[key.name] = key;\n      this.data[idx.name] = idx;\n      for(let i=0; i<dataList.length; i++) {\n        let datapoints = dataList[i].datapoints;\n        if(datapoints.length > 0) {\n          let val = {\n            name: dataList[i].target,\n            type: 'number',\n            missing: 0,\n            idx: i,\n            points: []\n          };\n          if(_.isString(datapoints[0][0])) {\n            val.type = 'string';\n          }\n          else if(_.isBoolean(datapoints[0][0])) {\n            val.type = 'boolean';\n          }\n\n          // Set the default mapping values\n          if(i==0) {\n            dmapping.x = val.name;\n          }\n          else if(i==1) {\n            dmapping.y = val.name;\n          }\n          else if(i==2) {\n            dmapping.z = val.name;\n          }\n\n          this.data[val.name] = val;\n          if(key.points.length==0) {\n            for(var j=0; j<datapoints.length; j++) {\n              key.points.push( datapoints[j][1] );\n              val.points.push( datapoints[j][0] );\n              idx.points.push( j );\n            }\n          }\n          else {\n            for(var j=0; j<datapoints.length; j++) {\n              if(j >= key.points.length ) {\n                break;\n              }\n              // Make sure it is from the same timestamp\n              if(key.points[j] == datapoints[j][1]) {\n                val.points.push( datapoints[j][0] );\n              }\n              else {\n                val.missing = val.missing+1;\n              }\n            }\n          }\n        }\n      }\n\n      // Maybe overwrite?\n      if(!mapping.x) mapping.x = dmapping.x;\n      if(!mapping.y) mapping.y = dmapping.y;\n      if(!mapping.z) mapping.z = dmapping.z;\n\n     // console.log( \"GOT\", this.data, mapping );\n\n      var dX = this.data[mapping.x];\n      var dY = this.data[mapping.y];\n      var dZ = null;\n      var dC = null;\n      var dS = null;\n      var dT = null;\n\n      if(!dX) {\n        throw { message: \"Unable to find X: \"+mapping.x };\n      }\n      if(!dY) {\n        throw { message: \"Unable to find Y: \"+mapping.y };\n      }\n\n\n      this.trace.ts = key.points;\n      this.trace.x = dX.points;\n      this.trace.y = dY.points;\n\n      if(cfg.settings.type == 'scatter3d') {\n        dZ = this.data[mapping.z];\n        if(!dZ) {\n          throw { message: \"Unable to find Z: \"+mapping.z };\n        }\n        this.layout.scene.xaxis.title = dX.name;\n        this.layout.scene.yaxis.title = dY.name;\n        this.layout.scene.zaxis.title = dZ.name;\n\n        this.trace.z = dZ.points;\n        console.log( \"3D\", this.layout);\n      }\n      else {\n        this.layout.xaxis.title = dX.name;\n        this.layout.yaxis.title = dY.name;\n      }\n\n\n      this.trace.marker = $.extend(true, {}, cfg.settings.marker);\n      this.trace.line = $.extend(true, {}, cfg.settings.line);\n\n      if(mapping.size) {\n        dS = this.data[mapping.size];\n        if(!dS) {\n          throw { message: \"Unable to find Size: \"+mapping.size };\n        }\n        this.trace.marker.size = dS.points;\n      }\n\n      // Set the marker colors\n      if( cfg.settings.color_option == 'ramp' ) {\n        if(!mapping.color) {\n          mapping.color = idx.name;\n        }\n        dC = this.data[mapping.color];\n        if(!dC) {\n          throw { message: \"Unable to find Color: \"+mapping.color };\n        }\n        this.trace.marker.color = dC.points;\n      }\n\n      console.log( \"TRACE\", this.trace );\n    }\n    this.initalized = false;\n    this.render();\n  }\n\n  onConfigChanged() {\n    console.log( \"Config changed...\");\n    if(this.graph) {\n      Plotly.Plots.purge(this.graph);\n      this.graph.innerHTML = '';\n      this.initalized = false;\n    }\n\n    var cfg = this.panel.pconfig;\n\n    if (this.trace.constructor === Array) {\n      for(let i=0; i<this.trace.length; i++) {\n        this.trace[i].type = cfg.settings.type;\n        this.trace[i].mode = cfg.settings.mode;\n      }\n    } else {\n      this.trace.type = cfg.settings.type;\n      this.trace.mode = cfg.settings.mode;\n    }\n\n    var axis = [ this.panel.pconfig.layout.xaxis, this.panel.pconfig.layout.yaxis];\n    for(let i=0; i<axis.length; i++) {\n      if( axis[i].rangemode === 'between' ) {\n        if( axis[i].range == null) {\n          axis[i].range = [0, null];\n        }\n      }\n      else {\n        axis[i].range = null;\n      }\n    }\n    this.refresh();\n  }\n\n  link(scope, elem, attrs, ctrl) {\n    this.graph = elem.find('.plotly-spot')[0];\n    this.initalized = false;\n    elem.on( 'mousemove', (evt) => {\n      this.mouse = evt;\n    });\n  }\n\n  //---------------------------\n\n\n  getSymbolSegs()\n  {\n    var txt = [\n\"circle\",\"circle-open\",\"circle-dot\",\"circle-open-dot\",\n\"square\",\"square-open\",\"square-dot\",\"square-open-dot\",\n\"diamond\",\"diamond-open\",\n\"diamond-dot\",\"diamond-open-dot\",\n\"cross\",\"cross-open\",\n\"cross-dot\",\"cross-open-dot\",\n\"x\",\"x-open\",\"x-dot\",\"x-open-dot\",\n\"triangle-up\",\n\"triangle-up-open\",\n\"triangle-up-dot\",\n\"triangle-up-open-dot\",\n\"triangle-down\",\n\"triangle-down-open\",\n\"triangle-down-dot\",\n\"triangle-down-open-dot\",\n\"triangle-left\",\n\"triangle-left-open\",\n\"triangle-left-dot\",\n\"triangle-left-open-dot\",\n\"triangle-right\",\n\"triangle-right-open\",\n\"triangle-right-dot\",\n\"triangle-right-open-dot\",\n\"triangle-ne\",\n\"triangle-ne-open\",\n\"triangle-ne-dot\",\n\"triangle-ne-open-dot\",\n\"triangle-se\",\n\"triangle-se-open\",\n\"triangle-se-dot\",\n\"triangle-se-open-dot\",\n\"triangle-sw\",\n\"triangle-sw-open\",\n\"triangle-sw-dot\",\n\"triangle-sw-open-dot\",\n\"triangle-nw\",\n\"triangle-nw-open\",\n\"triangle-nw-dot\",\n\"triangle-nw-open-dot\",\n\"pentagon\",\n\"pentagon-open\",\n\"pentagon-dot\",\n\"pentagon-open-dot\",\n\"hexagon\",\n\"hexagon-open\",\n\"hexagon-dot\",\n\"hexagon-open-dot\",\n\"hexagon2\",\n\"hexagon2-open\",\n\"hexagon2-dot\",\n\"hexagon2-open-dot\",\n\"octagon\",\n\"octagon-open\",\n\"octagon-dot\",\n\"octagon-open-dot\",\n\"star\",\n\"star-open\",\n\"star-dot\",\n\"star-open-dot\",\n\"hexagram\",\n\"hexagram-open\",\n\"hexagram-dot\",\n\"hexagram-open-dot\",\n\"star-triangle-up\",\n\"star-triangle-up-open\",\n\"star-triangle-up-dot\",\n\"star-triangle-up-open-dot\",\n\"star-triangle-down\",\n\"star-triangle-down-open\",\n\"star-triangle-down-dot\",\n\"star-triangle-down-open-dot\",\n\"star-square\",\n\"star-square-open\",\n\"star-square-dot\",\n\"star-square-open-dot\",\n\"star-diamond\",\n\"star-diamond-open\",\n\"star-diamond-dot\",\n\"star-diamond-open-dot\",\n\"diamond-tall\",\n\"diamond-tall-open\",\n\"diamond-tall-dot\",\n\"diamond-tall-open-dot\",\n\"diamond-wide\",\n\"diamond-wide-open\",\n\"diamond-wide-dot\",\n\"diamond-wide-open-dot\",\n\"hourglass\",\n\"hourglass-open\",\n\"bowtie\",\n\"bowtie-open\",\n\"circle-cross\",\n\"circle-cross-open\",\n\"circle-x\",\n\"circle-x-open\",\n\"square-cross\",\n\"square-cross-open\",\n\"square-x\",\n\"square-x-open\",\n\"diamond-cross\",\n\"diamond-cross-open\",\n\"diamond-x\",\n\"diamond-x-open\",\n\"cross-thin\",\n\"cross-thin-open\",\n\"x-thin\",\n\"x-thin-open\",\n\"asterisk\",\n\"asterisk-open\",\n\"hash\",\n\"hash-open\",\n\"hash-dot\",\n\"hash-open-dot\",\n\"y-up\",\n\"y-up-open\",\n\"y-down\",\n\"y-down-open\",\n\"y-left\",\n\"y-left-open\",\n\"y-right\",\n\"y-right-open\",\n\"line-ew\",\n\"line-ew-open\",\n\"line-ns\",\n\"line-ns-open\",\n\"line-ne\",\n\"line-ne-open\",\n\"line-nw\",\n\"line-nw-open\"\n    ];\n\n    var segs = [];\n    _.forEach(txt, (val) => {\n      segs.push( this.uiSegmentSrv.newSegment( val ) );\n    });\n    return this.q.when( segs );\n  }\n}\nPlotlyPanelCtrl.templateUrl = 'module.html';\n\nexport {\n  PlotlyPanelCtrl as PanelCtrl\n};\n\n\n"]}